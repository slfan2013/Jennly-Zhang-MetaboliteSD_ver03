# 6 in null, the correlation phenotype metabolite (correlation male).csv
pacman::p_load(data.table, corrplot)
cor_data_male= fread("6 in null, the correlation phenotype metabolite (correlation male).csv")
cor_male = data.matrix(cor_data_male[,-1,with=FALSE])
# rownames(cor_male) = colnames(cor_male) = NULL
cor_p_data_male= fread("6 in null, the correlation phenotype metabolite (correlation p value male).csv")
cor_p_male = data.matrix(cor_p_data_male[,-1,with=FALSE])
cor_data_female= fread("6 in null, the correlation phenotype metabolite (correlation female).csv")
cor_female = data.matrix(cor_data_female[,-1,with=FALSE])
# rownames(cor_female) = colnames(cor_female) = NULL
cor_p_data_female= fread("6 in null, the correlation phenotype metabolite (correlation p value female).csv")
cor_p_female = data.matrix(cor_p_data_female[,-1,with=FALSE])
different_direction_index = which(cor_male * cor_female < 0 & cor_p_female < 0.05 & cor_p_male < 0.05, arr.ind = T)
different_direction_index_row_unique = unique(different_direction_index[,1])
different_direction_index_col_unique = unique(different_direction_index[,2])
par(mfrow=c(1,2))
corrplot(cor_male[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_male[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
corrplot(cor_female[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_female[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
par(mfrow=c(1,1))
data = cor_female[different_direction_index_row_unique,different_direction_index_col_unique] - cor_male[different_direction_index_row_unique,different_direction_index_col_unique]
data_row_order =  hclust(dist(data))$order
data_col_order =  hclust(dist(t(data)))$order
p_data = cor_p_male[different_direction_index_row_unique,different_direction_index_col_unique]
corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("pch", "p-value", "blank", "n", "label_sig"))
fake_p = matrix(0, nrow = nrow(cor_female), ncol = ncol(cor_female))
for(i in 1:nrow(different_direction_index)){
fake_p[different_direction_index[i,1],different_direction_index[i,2]] = 1
}
fake_p = fake_p[different_direction_index_row_unique, different_direction_index_col_unique]
corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("pch"), p.mat = fake_p[data_row_order,data_col_order], pch = 22, pch.col = "black", pch.cex = 2)
# corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("p-value"), p.mat = p_data)
#
# corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("blank"), p.mat = p_data)
#
# corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("n"), p.mat = p_data)
#
# corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("label_sig"), p.mat = p_data)
?corrplot
# 6 in null, the correlation phenotype metabolite (correlation male).csv
pacman::p_load(data.table, corrplot)
cor_data_male= fread("6 in null, the correlation phenotype metabolite (correlation male).csv")
cor_male = data.matrix(cor_data_male[,-1,with=FALSE])
# rownames(cor_male) = colnames(cor_male) = NULL
cor_p_data_male= fread("6 in null, the correlation phenotype metabolite (correlation p value male).csv")
cor_p_male = data.matrix(cor_p_data_male[,-1,with=FALSE])
cor_data_female= fread("6 in null, the correlation phenotype metabolite (correlation female).csv")
cor_female = data.matrix(cor_data_female[,-1,with=FALSE])
# rownames(cor_female) = colnames(cor_female) = NULL
cor_p_data_female= fread("6 in null, the correlation phenotype metabolite (correlation p value female).csv")
cor_p_female = data.matrix(cor_p_data_female[,-1,with=FALSE])
different_direction_index = which(cor_male * cor_female < 0 & cor_p_female < 0.05 & cor_p_male < 0.05, arr.ind = T)
different_direction_index_row_unique = unique(different_direction_index[,1])
different_direction_index_col_unique = unique(different_direction_index[,2])
par(mfrow=c(1,2))
corrplot(cor_male[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_male[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
corrplot(cor_female[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_female[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
par(mfrow=c(1,1))
data = cor_female[different_direction_index_row_unique,different_direction_index_col_unique] - cor_male[different_direction_index_row_unique,different_direction_index_col_unique]
data_row_order =  hclust(dist(data))$order
data_col_order =  hclust(dist(t(data)))$order
p_data = cor_p_male[different_direction_index_row_unique,different_direction_index_col_unique]
corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("pch", "p-value", "blank", "n", "label_sig"))
fake_p = matrix(0, nrow = nrow(cor_female), ncol = ncol(cor_female))
for(i in 1:nrow(different_direction_index)){
fake_p[different_direction_index[i,1],different_direction_index[i,2]] = 1
}
fake_p = fake_p[different_direction_index_row_unique, different_direction_index_col_unique]
corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("pch"), p.mat = fake_p[data_row_order,data_col_order], pch = 22, pch.col = "black", pch.cex = 2)
# 6 in null, the correlation phenotype metabolite (correlation male).csv
pacman::p_load(data.table, corrplot)
cor_data_male= fread("6 in null, the correlation phenotype metabolite (correlation male).csv")
cor_male = data.matrix(cor_data_male[,-1,with=FALSE])
# rownames(cor_male) = colnames(cor_male) = NULL
cor_p_data_male= fread("6 in null, the correlation phenotype metabolite (correlation p value male).csv")
cor_p_male = data.matrix(cor_p_data_male[,-1,with=FALSE])
cor_data_female= fread("6 in null, the correlation phenotype metabolite (correlation female).csv")
cor_female = data.matrix(cor_data_female[,-1,with=FALSE])
# rownames(cor_female) = colnames(cor_female) = NULL
cor_p_data_female= fread("6 in null, the correlation phenotype metabolite (correlation p value female).csv")
cor_p_female = data.matrix(cor_p_data_female[,-1,with=FALSE])
different_direction_index = which(cor_male * cor_female < 0 & cor_p_female < 0.05 & cor_p_male < 0.05, arr.ind = T)
different_direction_index_row_unique = unique(different_direction_index[,1])
different_direction_index_col_unique = unique(different_direction_index[,2])
par(mfrow=c(1,2))
corrplot(cor_male[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_male[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
corrplot(cor_female[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_female[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
par(mfrow=c(1,1))
data = cor_female[different_direction_index_row_unique,different_direction_index_col_unique] - cor_male[different_direction_index_row_unique,different_direction_index_col_unique]
data_row_order =  hclust(dist(data))$order
data_col_order =  hclust(dist(t(data)))$order
p_data = cor_p_male[different_direction_index_row_unique,different_direction_index_col_unique]
corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("pch", "p-value", "blank", "n", "label_sig"))
fake_p = matrix(0, nrow = nrow(cor_female), ncol = ncol(cor_female))
for(i in 1:nrow(different_direction_index)){
fake_p[different_direction_index[i,1],different_direction_index[i,2]] = 1
}
fake_p = fake_p[different_direction_index_row_unique, different_direction_index_col_unique]
corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("pch"), p.mat = fake_p[data_row_order,data_col_order], pch = 22, pch.col = "black", pch.cex = 2)
# corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("p-value"), p.mat = p_data)
#
# corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("blank"), p.mat = p_data)
#
# corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("n"), p.mat = p_data)
#
# corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("label_sig"), p.mat = p_data)
pacman::p_load(data.table, corrplot)
cor_data_male= fread("6 in null, the correlation phenotype metabolite (correlation male).csv")
cor_male = data.matrix(cor_data_male[,-1,with=FALSE])
cor_p_data_male= fread("6 in null, the correlation phenotype metabolite (correlation p value male).csv")
cor_p_male = data.matrix(cor_p_data_male[,-1,with=FALSE])
cor_data_female= fread("6 in null, the correlation phenotype metabolite (correlation female).csv")
cor_female = data.matrix(cor_data_female[,-1,with=FALSE])
cor_p_data_female= fread("6 in null, the correlation phenotype metabolite (correlation p value female).csv")
cor_p_female = data.matrix(cor_p_data_female[,-1,with=FALSE])
different_direction_index = which(cor_male * cor_female < 0 & cor_p_female < 0.05 & cor_p_male < 0.05, arr.ind = T)
different_direction_index_row_unique = unique(different_direction_index[,1])
different_direction_index_col_unique = unique(different_direction_index[,2])
par(mfrow=c(1,2))
corrplot(cor_male[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_male[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
corrplot(cor_female[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_female[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
colnames(cor_male)
# 6 in null, the correlation phenotype metabolite (correlation male).csv
pacman::p_load(data.table, corrplot)
cor_data_male= fread("6 in null, the correlation phenotype metabolite (correlation male).csv")
cor_male = data.matrix(cor_data_male[,-1,with=FALSE])
# rownames(cor_male) = colnames(cor_male) = NULL
# 6 in null, the correlation phenotype metabolite (correlation male).csv
pacman::p_load(data.table, corrplot)
cor_data_male= fread("6 in null, the correlation phenotype metabolite (correlation male).csv")
cor_male = data.matrix(cor_data_male[,-1,with=FALSE])
# rownames(cor_male) = colnames(cor_male) = NULL
cor_p_data_male= fread("6 in null, the correlation phenotype metabolite (correlation p value male).csv")
cor_p_male = data.matrix(cor_p_data_male[,-1,with=FALSE])
cor_data_female= fread("6 in null, the correlation phenotype metabolite (correlation female).csv")
cor_female = data.matrix(cor_data_female[,-1,with=FALSE])
# rownames(cor_female) = colnames(cor_female) = NULL
cor_p_data_female= fread("6 in null, the correlation phenotype metabolite (correlation p value female).csv")
cor_p_female = data.matrix(cor_p_data_female[,-1,with=FALSE])
different_direction_index = which(cor_male * cor_female < 0 & cor_p_female < 0.05 & cor_p_male < 0.05, arr.ind = T)
different_direction_index_row_unique = unique(different_direction_index[,1])
different_direction_index_col_unique = unique(different_direction_index[,2])
par(mfrow=c(1,2))
corrplot(cor_male[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_male[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
corrplot(cor_female[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_female[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
par(mfrow=c(1,1))
data = cor_female[different_direction_index_row_unique,different_direction_index_col_unique] - cor_male[different_direction_index_row_unique,different_direction_index_col_unique]
data_row_order =  hclust(dist(data))$order
data_col_order =  hclust(dist(t(data)))$order
par(mfrow=c(1,1))
data = cor_female[different_direction_index_row_unique,different_direction_index_col_unique] - cor_male[different_direction_index_row_unique,different_direction_index_col_unique]
data_row_order =  hclust(dist(data))$order
data_col_order =  hclust(dist(t(data)))$order
p_data = cor_p_male[different_direction_index_row_unique,different_direction_index_col_unique]
corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("pch", "p-value", "blank", "n", "label_sig"))
fake_p = matrix(0, nrow = nrow(cor_female), ncol = ncol(cor_female))
for(i in 1:nrow(different_direction_index)){
fake_p[different_direction_index[i,1],different_direction_index[i,2]] = 1
}
fake_p = fake_p[different_direction_index_row_unique, different_direction_index_col_unique]
corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("pch"), p.mat = fake_p[data_row_order,data_col_order], pch = 22, pch.col = "black", pch.cex = 2)
data
rownames(data)
rownames(cor_female)
# 6 in null, the correlation phenotype metabolite (correlation male).csv
pacman::p_load(data.table, corrplot)
cor_data_male= fread("6 in null, the correlation phenotype metabolite (correlation male).csv")
cor_male = data.matrix(cor_data_male[,-1,with=FALSE])
cor_male
?cor_data_male
?fread
cor_data_male= fread("6 in null, the correlation phenotype metabolite (correlation male).csv")
cor_data_male
cor_data_male$V1
# 6 in null, the correlation phenotype metabolite (correlation male).csv
pacman::p_load(data.table, corrplot)
cor_data_male= fread("6 in null, the correlation phenotype metabolite (correlation male).csv")
cor_data_male_label = cor_data_male[[1]]
cor_male = data.matrix(cor_data_male[,-1,with=FALSE])
# rownames(cor_male) = colnames(cor_male) = NULL
# 6 in null, the correlation phenotype metabolite (correlation male).csv
pacman::p_load(data.table, corrplot)
cor_data_male= fread("6 in null, the correlation phenotype metabolite (correlation male).csv")
cor_data_male_label = cor_data_male[[1]]
cor_male = data.matrix(cor_data_male[,-1,with=FALSE])
# rownames(cor_male) = colnames(cor_male) = NULL
cor_p_data_male= fread("6 in null, the correlation phenotype metabolite (correlation p value male).csv")
cor_p_male = data.matrix(cor_p_data_male[,-1,with=FALSE])
cor_data_female= fread("6 in null, the correlation phenotype metabolite (correlation female).csv")
cor_data_female_label = cor_data_female[[1]]
cor_female = data.matrix(cor_data_female[,-1,with=FALSE])
# rownames(cor_female) = colnames(cor_female) = NULL
cor_p_data_female= fread("6 in null, the correlation phenotype metabolite (correlation p value female).csv")
cor_p_female = data.matrix(cor_p_data_female[,-1,with=FALSE])
different_direction_index = which(cor_male * cor_female < 0 & cor_p_female < 0.05 & cor_p_male < 0.05, arr.ind = T)
different_direction_index_row_unique = unique(different_direction_index[,1])
different_direction_index_col_unique = unique(different_direction_index[,2])
par(mfrow=c(1,2))
corrplot(cor_male[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_male[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
corrplot(cor_female[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_female[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
par(mfrow=c(1,1))
data = cor_female[different_direction_index_row_unique,different_direction_index_col_unique] - cor_male[different_direction_index_row_unique,different_direction_index_col_unique]
data_row_order =  hclust(dist(data))$order
data_col_order =  hclust(dist(t(data)))$order
p_data = cor_p_male[different_direction_index_row_unique,different_direction_index_col_unique]
corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("pch", "p-value", "blank", "n", "label_sig"))
fake_p = matrix(0, nrow = nrow(cor_female), ncol = ncol(cor_female))
for(i in 1:nrow(different_direction_index)){
fake_p[different_direction_index[i,1],different_direction_index[i,2]] = 1
}
fake_p = fake_p[different_direction_index_row_unique, different_direction_index_col_unique]
corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("pch"), p.mat = fake_p[data_row_order,data_col_order], pch = 22, pch.col = "black", pch.cex = 2)
# rownames(cor_male) = colnames(cor_male) = NULL
rownames(cor_male) = cor_data_male_label
# 6 in null, the correlation phenotype metabolite (correlation male).csv
pacman::p_load(data.table, corrplot)
cor_data_male= fread("6 in null, the correlation phenotype metabolite (correlation male).csv")
cor_data_male_label = cor_data_male[[1]]
cor_male = data.matrix(cor_data_male[,-1,with=FALSE])
# rownames(cor_male) = colnames(cor_male) = NULL
rownames(cor_male) = cor_data_male_label
cor_p_data_male= fread("6 in null, the correlation phenotype metabolite (correlation p value male).csv")
cor_p_male = data.matrix(cor_p_data_male[,-1,with=FALSE])
cor_data_female= fread("6 in null, the correlation phenotype metabolite (correlation female).csv")
cor_data_female_label = cor_data_female[[1]]
cor_female = data.matrix(cor_data_female[,-1,with=FALSE])
# rownames(cor_female) = colnames(cor_female) = NULL
rownames(cor_female) = cor_data_female_label
cor_p_data_female= fread("6 in null, the correlation phenotype metabolite (correlation p value female).csv")
cor_p_female = data.matrix(cor_p_data_female[,-1,with=FALSE])
different_direction_index = which(cor_male * cor_female < 0 & cor_p_female < 0.05 & cor_p_male < 0.05, arr.ind = T)
different_direction_index_row_unique = unique(different_direction_index[,1])
different_direction_index_col_unique = unique(different_direction_index[,2])
par(mfrow=c(1,2))
corrplot(cor_male[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_male[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
corrplot(cor_female[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_female[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
par(mfrow=c(1,1))
data = cor_female[different_direction_index_row_unique,different_direction_index_col_unique] - cor_male[different_direction_index_row_unique,different_direction_index_col_unique]
data_row_order =  hclust(dist(data))$order
data_col_order =  hclust(dist(t(data)))$order
p_data = cor_p_male[different_direction_index_row_unique,different_direction_index_col_unique]
corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("pch", "p-value", "blank", "n", "label_sig"))
fake_p = matrix(0, nrow = nrow(cor_female), ncol = ncol(cor_female))
for(i in 1:nrow(different_direction_index)){
fake_p[different_direction_index[i,1],different_direction_index[i,2]] = 1
}
fake_p = fake_p[different_direction_index_row_unique, different_direction_index_col_unique]
corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("pch"), p.mat = fake_p[data_row_order,data_col_order], pch = 22, pch.col = "black", pch.cex = 2)
rownames(data)
# 6 in null, the correlation phenotype metabolite (correlation male).csv
pacman::p_load(data.table, corrplot)
cor_data_male= fread("6 in null, the correlation phenotype metabolite (correlation male).csv")
cor_data_male_label = cor_data_male[[1]]
cor_male = data.matrix(cor_data_male[,-1,with=FALSE])
# rownames(cor_male) = colnames(cor_male) = NULL
rownames(cor_male) = cor_data_male_label
cor_p_data_male= fread("6 in null, the correlation phenotype metabolite (correlation p value male).csv")
cor_p_male = data.matrix(cor_p_data_male[,-1,with=FALSE])
cor_data_female= fread("6 in null, the correlation phenotype metabolite (correlation female).csv")
cor_data_female_label = cor_data_female[[1]]
cor_female = data.matrix(cor_data_female[,-1,with=FALSE])
# rownames(cor_female) = colnames(cor_female) = NULL
rownames(cor_female) = cor_data_female_label
cor_p_data_female= fread("6 in null, the correlation phenotype metabolite (correlation p value female).csv")
cor_p_female = data.matrix(cor_p_data_female[,-1,with=FALSE])
different_direction_index = which(cor_male * cor_female < 0 & cor_p_female < 0.05 & cor_p_male < 0.05, arr.ind = T)
different_direction_index_row_unique = unique(different_direction_index[,1])
different_direction_index_col_unique = unique(different_direction_index[,2])
par(mfrow=c(1,2))
corrplot(cor_male[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_male[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
corrplot(cor_female[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_female[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
par(mfrow=c(1,1))
data = cor_female[different_direction_index_row_unique,different_direction_index_col_unique] - cor_male[different_direction_index_row_unique,different_direction_index_col_unique]
data_row_order =  hclust(dist(data))$order
data_col_order =  hclust(dist(t(data)))$order
p_data = cor_p_male[different_direction_index_row_unique,different_direction_index_col_unique]
corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("pch", "p-value", "blank", "n", "label_sig"))
fake_p = matrix(0, nrow = nrow(cor_female), ncol = ncol(cor_female))
for(i in 1:nrow(different_direction_index)){
fake_p[different_direction_index[i,1],different_direction_index[i,2]] = 1
}
fake_p = fake_p[different_direction_index_row_unique, different_direction_index_col_unique]
corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("pch"), p.mat = fake_p[data_row_order,data_col_order], pch = 22, pch.col = "black", pch.cex = 2)
# corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("p-value"), p.mat = p_data)
#
# corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("blank"), p.mat = p_data)
#
# corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("n"), p.mat = p_data)
#
# corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("label_sig"), p.mat = p_data)
rownames(data)
# 6 in null, the correlation phenotype metabolite (correlation male).csv
pacman::p_load(data.table, corrplot)
cor_data_male= fread("6 in null, the correlation phenotype metabolite (correlation male).csv")
cor_data_male_label = cor_data_male[[1]]
cor_male = data.matrix(cor_data_male[,-1,with=FALSE])
# rownames(cor_male) = colnames(cor_male) = NULL
rownames(cor_male) = cor_data_male_label
cor_p_data_male= fread("6 in null, the correlation phenotype metabolite (correlation p value male).csv")
cor_p_male = data.matrix(cor_p_data_male[,-1,with=FALSE])
cor_data_female= fread("6 in null, the correlation phenotype metabolite (correlation female).csv")
cor_data_female_label = cor_data_female[[1]]
cor_female = data.matrix(cor_data_female[,-1,with=FALSE])
# rownames(cor_female) = colnames(cor_female) = NULL
rownames(cor_female) = cor_data_female_label
cor_p_data_female= fread("6 in null, the correlation phenotype metabolite (correlation p value female).csv")
cor_p_female = data.matrix(cor_p_data_female[,-1,with=FALSE])
different_direction_index = which(cor_male * cor_female < 0 & cor_p_female < 0.05 & cor_p_male < 0.05, arr.ind = T)
different_direction_index_row_unique = unique(different_direction_index[,1])
different_direction_index_col_unique = unique(different_direction_index[,2])
par(mfrow=c(1,2))
corrplot(cor_male[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_male[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
corrplot(cor_female[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_female[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
par(mfrow=c(1,1))
data = cor_female[different_direction_index_row_unique,different_direction_index_col_unique] - cor_male[different_direction_index_row_unique,different_direction_index_col_unique]
data_row_order =  hclust(dist(data))$order
data_col_order =  hclust(dist(t(data)))$order
p_data = cor_p_male[different_direction_index_row_unique,different_direction_index_col_unique]
corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("pch", "p-value", "blank", "n", "label_sig"))
fake_p = matrix(0, nrow = nrow(cor_female), ncol = ncol(cor_female))
for(i in 1:nrow(different_direction_index)){
fake_p[different_direction_index[i,1],different_direction_index[i,2]] = 1
}
fake_p = fake_p[different_direction_index_row_unique, different_direction_index_col_unique]
corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("pch"), p.mat = fake_p[data_row_order,data_col_order], pch = 22, pch.col = "black", pch.cex = 2)
# corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("p-value"), p.mat = p_data)
#
# corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("blank"), p.mat = p_data)
#
# corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("n"), p.mat = p_data)
#
# corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("label_sig"), p.mat = p_data)
?corrplot
label_data = fread("Metabolite Label_KOMP correlation.csv")
label_data
label_data = fread("Metabolite Label_KOMP correlation.csv", header = FALSE)
label_data
label_data = fread("Metabolite Label_KOMP correlation.csv", header = FALSE)
# 6 in null, the correlation phenotype metabolite (correlation male).csv
pacman::p_load(data.table, corrplot)
cor_data_male= fread("6 in null, the correlation phenotype metabolite (correlation male).csv")
colnames(cor_data_male)
cor_data_male[[1]]
colnames(cor_data_male)
colnames(label_data)
label_data$v`1`
label_data$V1
label_data$V2
cor_data_male = merge(cor_data_male, label_data, by.x = "V1", by.y = "V2", sort = FALSE)
cor_data_male
label_data = fread("Metabolite Label_KOMP correlation.csv", header = FALSE)
# 6 in null, the correlation phenotype metabolite (correlation male).csv
pacman::p_load(data.table, corrplot)
cor_data_male= fread("6 in null, the correlation phenotype metabolite (correlation male).csv")
cor_data_male = merge(cor_data_male, label_data, by.x = "V1", by.y = "V2", sort = FALSE)
cor_data_male_label = cor_data_male[["V3"]]
label_data = fread("Metabolite Label_KOMP correlation.csv", header = FALSE)
# 6 in null, the correlation phenotype metabolite (correlation male).csv
pacman::p_load(data.table, corrplot)
cor_data_male= fread("6 in null, the correlation phenotype metabolite (correlation male).csv")
cor_data_male = merge(cor_data_male, label_data, by.x = "V1", by.y = "V2", sort = FALSE)
cor_data_male_label = cor_data_male[["V3"]]
cor_male = data.matrix(cor_data_male[,-c(1, ncol(cor_data_male), ncol(cor_data_male)-1),with=FALSE])
cor_male
# rownames(cor_male) = colnames(cor_male) = NULL
rownames(cor_male) = cor_data_male_label
label_data = fread("Metabolite Label_KOMP correlation.csv", header = FALSE)
# 6 in null, the correlation phenotype metabolite (correlation male).csv
pacman::p_load(data.table, corrplot)
cor_data_male= fread("6 in null, the correlation phenotype metabolite (correlation male).csv")
cor_data_male = merge(cor_data_male, label_data, by.x = "V1", by.y = "V2", sort = FALSE)
cor_data_male_label = cor_data_male[["V3"]]
cor_male = data.matrix(cor_data_male[,-c(1, ncol(cor_data_male), ncol(cor_data_male)-1),with=FALSE])
# rownames(cor_male) = colnames(cor_male) = NULL
rownames(cor_male) = cor_data_male_label
cor_p_data_male= fread("6 in null, the correlation phenotype metabolite (correlation p value male).csv")
cor_p_male = data.matrix(cor_p_data_male[,-1,with=FALSE])
label_data = fread("Metabolite Label_KOMP correlation.csv", header = FALSE)
# 6 in null, the correlation phenotype metabolite (correlation male).csv
pacman::p_load(data.table, corrplot)
cor_data_male= fread("6 in null, the correlation phenotype metabolite (correlation male).csv")
cor_data_male = merge(cor_data_male, label_data, by.x = "V1", by.y = "V2", sort = FALSE)
cor_data_male_label = cor_data_male[["V3"]]
cor_male = data.matrix(cor_data_male[,-c(1, ncol(cor_data_male), ncol(cor_data_male)-1),with=FALSE])
# rownames(cor_male) = colnames(cor_male) = NULL
rownames(cor_male) = cor_data_male_label
cor_p_data_male= fread("6 in null, the correlation phenotype metabolite (correlation p value male).csv")
cor_p_male = data.matrix(cor_p_data_male[,-1,with=FALSE])
# 6 in null, the correlation phenotype metabolite (correlation female).csv
cor_data_female= fread("6 in null, the correlation phenotype metabolite (correlation female).csv")
cor_data_female = merge(cor_data_female, label_data, by.x = "V1", by.y = "V2", sort = FALSE)
cor_data_female_label = cor_data_female[["V3"]]
cor_female = data.matrix(cor_data_female[,-c(1, ncol(cor_data_female), ncol(cor_data_female)-1),with=FALSE])
# rownames(cor_female) = colnames(cor_female) = NULL
rownames(cor_female) = cor_data_female_label
cor_p_data_female= fread("6 in null, the correlation phenotype metabolite (correlation p value female).csv")
cor_p_female = data.matrix(cor_p_data_female[,-1,with=FALSE])
different_direction_index = which(cor_male * cor_female < 0 & cor_p_female < 0.05 & cor_p_male < 0.05, arr.ind = T)
different_direction_index_row_unique = unique(different_direction_index[,1])
different_direction_index_col_unique = unique(different_direction_index[,2])
par(mfrow=c(1,2))
corrplot(cor_male[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_male[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
corrplot(cor_female[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_female[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
par(mfrow=c(1,1))
data = cor_female[different_direction_index_row_unique,different_direction_index_col_unique] - cor_male[different_direction_index_row_unique,different_direction_index_col_unique]
data_row_order =  hclust(dist(data))$order
data_col_order =  hclust(dist(t(data)))$order
p_data = cor_p_male[different_direction_index_row_unique,different_direction_index_col_unique]
corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("pch", "p-value", "blank", "n", "label_sig"))
fake_p = matrix(0, nrow = nrow(cor_female), ncol = ncol(cor_female))
for(i in 1:nrow(different_direction_index)){
fake_p[different_direction_index[i,1],different_direction_index[i,2]] = 1
}
fake_p = fake_p[different_direction_index_row_unique, different_direction_index_col_unique]
corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("pch"), p.mat = fake_p[data_row_order,data_col_order], pch = 22, pch.col = "black", pch.cex = 2)
different_direction_index = which(cor_male * cor_female < 0 & cor_p_female < 0.05 & cor_p_male < 0.05, arr.ind = T)
label_data = fread("Metabolite Label_KOMP correlation.csv", header = FALSE)
# 6 in null, the correlation phenotype metabolite (correlation male).csv
pacman::p_load(data.table, corrplot)
cor_data_male= fread("6 in null, the correlation phenotype metabolite (correlation male).csv")
cor_data_male = merge(cor_data_male, label_data, by.x = "V1", by.y = "V2", sort = FALSE)
cor_data_male_label = cor_data_male[["V3"]]
cor_male = data.matrix(cor_data_male[,-c(1, ncol(cor_data_male), ncol(cor_data_male)-1),with=FALSE])
# rownames(cor_male) = colnames(cor_male) = NULL
rownames(cor_male) = cor_data_male_label
cor_p_data_male= fread("6 in null, the correlation phenotype metabolite (correlation p value male).csv")
cor_p_male = data.matrix(cor_p_data_male[,-1,with=FALSE])
# 6 in null, the correlation phenotype metabolite (correlation female).csv
cor_data_female= fread("6 in null, the correlation phenotype metabolite (correlation female).csv")
cor_data_female = merge(cor_data_female, label_data, by.x = "V1", by.y = "V2", sort = FALSE)
cor_data_female_label = cor_data_female[["V3"]]
cor_female = data.matrix(cor_data_female[,-c(1, ncol(cor_data_female), ncol(cor_data_female)-1),with=FALSE])
# rownames(cor_female) = colnames(cor_female) = NULL
rownames(cor_female) = cor_data_female_label
cor_p_data_female= fread("6 in null, the correlation phenotype metabolite (correlation p value female).csv")
cor_p_female = data.matrix(cor_p_data_female[,-1,with=FALSE])
different_direction_index = which(cor_male * cor_female < 0 & cor_p_female < 0.05 & cor_p_male < 0.05, arr.ind = T)
different_direction_index_row_unique = unique(different_direction_index[,1])
different_direction_index_col_unique = unique(different_direction_index[,2])
par(mfrow=c(1,2))
corrplot(cor_male[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_male[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
corrplot(cor_female[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_female[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
par(mfrow=c(1,1))
data = cor_female[different_direction_index_row_unique,different_direction_index_col_unique] - cor_male[different_direction_index_row_unique,different_direction_index_col_unique]
data_row_order =  hclust(dist(data))$order
data_col_order =  hclust(dist(t(data)))$order
p_data = cor_p_male[different_direction_index_row_unique,different_direction_index_col_unique]
corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("pch", "p-value", "blank", "n", "label_sig"))
fake_p = matrix(0, nrow = nrow(cor_female), ncol = ncol(cor_female))
for(i in 1:nrow(different_direction_index)){
fake_p[different_direction_index[i,1],different_direction_index[i,2]] = 1
}
fake_p = fake_p[different_direction_index_row_unique, different_direction_index_col_unique]
corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("pch"), p.mat = fake_p[data_row_order,data_col_order], pch = 22, pch.col = "black", pch.cex = 2)
# corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("p-value"), p.mat = p_data)
#
# corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("blank"), p.mat = p_data)
#
# corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("n"), p.mat = p_data)
#
# corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("label_sig"), p.mat = p_data)
par(mfrow=c(1,2))
corrplot(cor_male[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_male[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
corrplot(cor_female[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_female[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
par(mfrow=c(1,1))
corrplot(cor_male[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_male[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
corrplot(cor_female[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_female[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
?corrplot
label_data = fread("Metabolite Label_KOMP correlation.csv", header = FALSE)
# 6 in null, the correlation phenotype metabolite (correlation male).csv
pacman::p_load(data.table, corrplot)
cor_data_male= fread("6 in null, the correlation phenotype metabolite (correlation male).csv")
cor_data_male = merge(cor_data_male, label_data, by.x = "V1", by.y = "V2", sort = FALSE)
cor_data_male_label = cor_data_male[["V3"]]
cor_male = data.matrix(cor_data_male[,-c(1, ncol(cor_data_male), ncol(cor_data_male)-1),with=FALSE])
# rownames(cor_male) = colnames(cor_male) = NULL
rownames(cor_male) = cor_data_male_label
cor_p_data_male= fread("6 in null, the correlation phenotype metabolite (correlation p value male).csv")
cor_p_male = data.matrix(cor_p_data_male[,-1,with=FALSE])
# 6 in null, the correlation phenotype metabolite (correlation female).csv
cor_data_female= fread("6 in null, the correlation phenotype metabolite (correlation female).csv")
cor_data_female = merge(cor_data_female, label_data, by.x = "V1", by.y = "V2", sort = FALSE)
cor_data_female_label = cor_data_female[["V3"]]
cor_female = data.matrix(cor_data_female[,-c(1, ncol(cor_data_female), ncol(cor_data_female)-1),with=FALSE])
# rownames(cor_female) = colnames(cor_female) = NULL
rownames(cor_female) = cor_data_female_label
cor_p_data_female= fread("6 in null, the correlation phenotype metabolite (correlation p value female).csv")
cor_p_female = data.matrix(cor_p_data_female[,-1,with=FALSE])
different_direction_index = which(cor_male * cor_female < 0 & cor_p_female < 0.05 & cor_p_male < 0.05, arr.ind = T)
different_direction_index_row_unique = unique(different_direction_index[,1])
different_direction_index_col_unique = unique(different_direction_index[,2])
par(mfrow=c(1,1))
corrplot(cor_male[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_male[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
?corrplot
corrplot(cor_female[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_female[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
different_direction_index = which(cor_male * cor_female < 0 & cor_p_female < 0.05 & cor_p_male < 0.05, arr.ind = T)
different_direction_index_row_unique = unique(different_direction_index[,1])
different_direction_index_col_unique = unique(different_direction_index[,2])
par(mfrow=c(1,1))
corrplot(cor_male[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_male[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
corrplot(cor_female[different_direction_index_row_unique,different_direction_index_col_unique], p.mat = cor_p_female[different_direction_index_row_unique,different_direction_index_col_unique], method="circle", insig = "blank")
par(mfrow=c(1,1))
data = cor_female[different_direction_index_row_unique,different_direction_index_col_unique] - cor_male[different_direction_index_row_unique,different_direction_index_col_unique]
data_row_order =  hclust(dist(data))$order
data_col_order =  hclust(dist(t(data)))$order
p_data = cor_p_male[different_direction_index_row_unique,different_direction_index_col_unique]
corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("pch", "p-value", "blank", "n", "label_sig"))
fake_p = matrix(0, nrow = nrow(cor_female), ncol = ncol(cor_female))
for(i in 1:nrow(different_direction_index)){
fake_p[different_direction_index[i,1],different_direction_index[i,2]] = 1
}
fake_p = fake_p[different_direction_index_row_unique, different_direction_index_col_unique]
corrplot(data[data_row_order,data_col_order], is.corr = FALSE, insig = c("pch"), p.mat = fake_p[data_row_order,data_col_order], pch = 22, pch.col = "black", pch.cex = 2)
